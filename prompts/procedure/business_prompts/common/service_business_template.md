请按照以下代码结构编写Service业务逻辑代码：

代码模式：
- 服务模式：Service类封装 + 数据库会话注入 + 异步方法实现
- 算法模式：工具类调用(可选) + 复杂逻辑分解 + 数据处理流程
- 数据模式：ORM查询 + 批量操作 + 事务管理
- 异常模式：BusinessException抛出 + 数据库回滚 + 日志记录

公共规范：
- 导入规范：sqlalchemy.orm.Session + models模型类 + utils工具类 + schemas响应类 + typing类型提示
- Service规范：类初始化注入数据库会话 + 异步方法定义 + try-catch异常处理
- 数据库规范：ORM查询 + 批量操作 + 事务提交回滚 + flush立即生效
- 算法规范：工具类静态方法调用(可选) + 数据结构转换 + 逻辑步骤分解

业务逻辑模板：
```
{业务方法}({参数列表}) -> {返回类型}:
    数据获取({查询条件}, {数据验证})
    算法处理({工具类调用}, {数据转换}, {逻辑判断})
    数据操作({ORM操作}, {批量处理}, {关联更新})
    结果返回({数据组装}, {格式转换})
    异常处理({业务异常}, {数据库回滚})
```

业务实现参数模板：
```
数据获取参数：
- 查询条件：{具体查询逻辑}
- 数据验证：{具体验证逻辑}

算法处理参数：
- 工具类调用：{具体工具类方法}(可选)
- 数据转换：{具体转换逻辑}
- 逻辑判断：{具体判断逻辑}

数据操作参数：
- ORM操作：{具体数据库操作}
- 批量处理：{具体批量逻辑}(可选)
- 关联更新：{具体关联逻辑}(可选)

结果返回参数：
- 数据组装：{具体组装逻辑}
- 格式转换：{具体返回格式}

异常处理参数：
- 业务异常：{具体异常类型}
- 数据库回滚：{具体回滚逻辑}
```

常用业务模式：

CRUD基础模式：
- 创建业务：数据验证 → ORM插入 → 返回对象
- 查询业务：条件筛选 → ORM查询 → 返回列表/对象
- 更新业务：存在性检查 → ORM更新 → 返回结果
- 删除业务：存在性检查 → ORM删除 → 返回确认

复杂算法模式：
- 数据分析业务：数据获取 → 算法处理 → 结果计算 → 数据更新
- 批量处理业务：数据验证 → 批量操作 → 事务管理 → 结果统计
- 关联操作业务：多表查询 → 关系处理 → 级联更新 → 一致性检查

文件处理模式：
- 导入业务：文件读取 → 数据解析 → 批量插入 → 结果统计
- 导出业务：数据查询 → 格式转换 → 文件生成 → 路径返回

数据库操作规范：
- 查询操作：query().filter() → first()/all()
- 插入操作：Model对象创建 → add()/add_all() → commit()
- 更新操作：query().update() 或 merge() → commit()
- 删除操作：query().delete() 或 delete() → commit()
- 批量操作：add_all()/bulk_insert_mappings() → commit()
- 事务管理：try-except → commit()/rollback()

返回数据规范：
- 单对象返回：Model对象 或 Dict格式
- 列表返回：List[Model] 或 List[Dict]
- 分页返回：{items: List, total: int}格式
- 操作结果：{message: str}格式
- 复合返回：{message: str, data: Any}格式